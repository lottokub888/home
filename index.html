<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Lottery Web3 | Bitkub Chain</title>

<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>

<style>
:root{
--primary:#dc2626;--dark:#991b1b;--green:#16a34a;
--bg:#f8fafc;--card:#fff;--text:#111827;
}
*{box-sizing:border-box}
body{margin:0;font-family:system-ui;background:var(--bg);color:var(--text)}
header{background:linear-gradient(90deg,var(--dark),var(--primary));color:#fff}
.container{max-width:1100px;margin:auto;padding:1.5rem}

button{
border:none;border-radius:999px;
padding:.7rem 1.6rem;font-weight:700;cursor:pointer
}
.primary{background:var(--primary);color:#fff}
.secondary{background:var(--green);color:#fff}
.ghost{background:#e5e7eb}

.card{
background:var(--card);border-radius:24px;padding:1.6rem;
box-shadow:0 20px 40px rgba(0,0,0,.1);margin-bottom:1.5rem
}

.wallet{display:flex;gap:.5rem;flex-wrap:wrap}
.pill{
background:#111;color:#fff;border-radius:999px;
padding:.3rem .8rem;font-size:.8rem
}

/* ===== TOAST ===== */
.toast{
position:fixed;right:20px;bottom:20px;
background:#111;color:#fff;padding:1rem 1.4rem;
border-radius:16px;opacity:0;transform:translateY(20px);
transition:.3s;z-index:999
}
.toast.show{opacity:1;transform:none}

/* ===== ONBOARDING ===== */
#onboarding{
position:fixed;inset:0;background:rgba(0,0,0,.65);
display:flex;align-items:center;justify-content:center;
z-index:1000
}
.onboard-box{
background:#fff;border-radius:24px;padding:2rem;
max-width:520px;width:90%;text-align:center
}
.step{display:none}
.step.active{display:block}
.step h2{margin-top:0}
.step p{color:#555}

</style>
</head>

<body>

<header>
<div class="container">
<h2>üéÑ Lottery Web3 ‚Äì Bitkub Chain</h2>
</div>
</header>

<div class="container">

<div class="card">
<h3>Wallet</h3>
<div class="wallet">
<button class="primary" onclick="connectWallet()">Connect MetaMask</button>
<button class="ghost" onclick="addMainnet()">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏° KUB Mainnet</button>
<button class="ghost" onclick="switchNetwork('testnet')">Testnet</button>
<button class="ghost" onclick="switchNetwork('mainnet')">Mainnet</button>
<span id="addr" class="pill" style="display:none"></span>
<span id="net" class="pill" style="display:none"></span>
<span id="bal" class="pill" style="display:none"></span>
</div>
</div>

</div>

<!-- TOAST -->
<div id="toast" class="toast"></div>

<!-- ONBOARDING -->
<div id="onboarding">
<div class="onboard-box">
<div class="step active">
<h2>üëã ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö</h2>
<p>‡πÄ‡∏ß‡πá‡∏ö‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ MetaMask ‡πÅ‡∏•‡∏∞ Bitkub Chain</p>
<button class="primary" onclick="nextStep()">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
</div>

<div class="step">
<h2>ü¶ä ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á MetaMask</h2>
<p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á MetaMask ‡∏ö‡∏ô Browser</p>
<button class="primary" onclick="nextStep()">‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡πâ‡∏ß</button>
</div>

<div class="step">
<h2>‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏° Bitkub Mainnet</h2>
<p>‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</p>
<button class="secondary" onclick="addMainnet()">‡πÄ‡∏û‡∏¥‡πà‡∏° Mainnet</button>
<br><br>
<button class="ghost" onclick="nextStep()">‡∏Ç‡πâ‡∏≤‡∏°</button>
</div>

<div class="step">
<h2>‚úÖ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h2>
<p>‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Wallet ‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß</p>
<button class="primary" onclick="closeOnboard()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</button>
</div>
</div>
</div>

<script>
/* ===== CONFIG ===== */
const MAINNET={
 chainId:'0x8E4',
 chainName:'Bitkub Chain',
 nativeCurrency:{name:'KUB',symbol:'KUB',decimals:18},
 rpcUrls:['https://rpc.bitkubchain.io'],
 blockExplorerUrls:['https://www.kubscan.com']
};
const TESTNET={
 chainId:'0x8E5',
 chainName:'Bitkub Chain Testnet',
 nativeCurrency:{name:'tKUB',symbol:'tKUB',decimals:18},
 rpcUrls:['https://rpc-testnet.bitkubchain.io'],
 blockExplorerUrls:['https://testnet.kubscan.com']
};

let provider,signer,account;
let step=0;

/* ===== TOAST ===== */
function toast(msg){
 const t=document.getElementById('toast');
 t.innerText=msg;
 t.classList.add('show');
 setTimeout(()=>t.classList.remove('show'),3000);
}

/* ===== ONBOARD ===== */
function nextStep(){
 document.querySelectorAll('.step')[step].classList.remove('active');
 step++;
 document.querySelectorAll('.step')[step].classList.add('active');
}
function closeOnboard(){
 document.getElementById('onboarding').style.display='none';
 localStorage.setItem('onboarded','1');
}
if(localStorage.getItem('onboarded')) closeOnboard();

/* ===== WALLET ===== */
async function connectWallet(){
 if(!window.ethereum){toast("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á MetaMask");return;}
 await ethereum.request({method:'eth_requestAccounts'});
 provider=new ethers.providers.Web3Provider(window.ethereum,'any');
 signer=provider.getSigner();
 account=await signer.getAddress();
 updateUI();
 toast("‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Wallet ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
}

async function addMainnet(){
 if(!window.ethereum)return;
 try{
  await ethereum.request({
   method:'wallet_addEthereumChain',
   params:[MAINNET]
  });
  toast("‡πÄ‡∏û‡∏¥‡πà‡∏° Bitkub Mainnet ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
 }catch{
  toast("‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° Network");
 }
}

async function switchNetwork(v){
 const p=v==='mainnet'?MAINNET:TESTNET;
 try{
  await ethereum.request({
   method:'wallet_switchEthereumChain',
   params:[{chainId:p.chainId}]
  });
  toast("‡∏™‡∏•‡∏±‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß");
  updateUI();
 }catch(e){
  toast("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏° Network");
 }
}

async function updateUI(){
 const netw=await provider.getNetwork();
 addr.innerText=account.slice(0,6)+'...'+account.slice(-4);
 addr.style.display='inline-block';
 net.innerText=netw.chainId===2276?'KUB Mainnet':'KUB Testnet';
 net.style.display='inline-block';
 const b=await provider.getBalance(account);
 bal.innerText=ethers.utils.formatEther(b)+(netw.chainId===2276?' KUB':' tKUB');
 bal.style.display='inline-block';
}
</script>

</body>
</html>
